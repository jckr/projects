var countryColors=[[0.000377573764578001,0.000553774854714402,0.000553774854714402,0.000553774854714402,0.000578946439019602,0.000578946439019602,0.000578946439019602,0.000679632776240402,0.000805490697766403,0.000805490697766403,0.000805490697766403,0.000830662282071603],[0.000526755833203839,0.000566262520694127,0.000579431416524223,0.000605769208184415,0.000645275895674703,0.000645275895674703,0.000697951478995086,0.000908653812276622,0.000974498291427102,0.00105351166640768,0.00109301835389797,0.00109301835389797],[0.029360053253199,0.0365502703764314,0.0377486398969701,0.0443396722599331,0.0515298893831655,0.0527282589037043,0.0569225522255898,0.0701046169515159,0.0731005407528627,0.0790923883555564,0.0844850511979807,0.0856834207185194],[0.112527758052406,0.130005891502081,0.140414218163124,0.147091257907944,0.156321283437548,0.163587473748087,0.175370485062475,0.274347780103334,0.309304047002686,0.330709850890491,0.346027765599195,0.34799160081826],[0.00730689732539003,0.00853671173565682,0.00919661215092193,0.00969453700971287,0.0101684654897669,0.0106723894432421,0.010960345988085,0.012274147723931,0.0128740571923539,0.0132699974415129,0.0139778906142519,0.0142658471590948],[0.0507287322317941,0.056493360894498,0.0576462866270388,0.0582227494933092,0.0674461553536354,0.07436370974888,0.0795518755453135,0.0916575957369917,0.108951481725103,0.112986721788996,0.1187513504517,0.1187513504517],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0.0280982811980517,0.0392559573567852,0.0427009245982865,0.045474849833689,0.0477914407082469,0.0502362561699575,0.0528007479130106,0.0593551613929638,0.0634113324998928,0.0658454625793407,0.0684655183101599,0.0691087783223758],[1.57386541974084,1.76143895534255,1.85024765691193,1.92471952773469,2.000386134453,2.08461501508944,2.15311320643443,2.29588414595293,2.38748056461193,2.48823662513684,2.59755495957987,2.62284353603573],[0.00774980434306276,0.00874336900242978,0.00933950779804999,0.0105317853892904,0.0111279241849106,0.0121214888442776,0.0131150535036447,0.0186790155961,0.0226532742335681,0.0232494130291883,0.0244416906204287,0.0248391164841755],[0.00703248780160386,0.00703248780160386,0.00703248780160386,0.00767180487447694,0.00767180487447694,0.00767180487447694,0.00767180487447694,0.00767180487447694,0.00895043902022309,0.00895043902022309,0.00958975609309617,0.00958975609309617],[2.86875336606456,3.48034924527848,3.65656259700235,3.83114936394107,4.07242610707068,4.36900673289515,4.5544373984015,5.69738430742892,6.11162123271211,6.49332646229243,6.88045364115655,7.00190530511393],[0.000742074779939461,0.000742074779939461,0.000890489735927354,0.00103890469191525,0.00133573460389103,0.00148414955987892,0.00148414955987892,0.00163256451586682,0.00163256451586682,0.0019293944278426,0.00222622433981838,0.00222622433981838],[0.00108010937048557,0.00114011544662366,0.00126012759889983,0.00126012759889983,0.00126012759889983,0.00132013367503792,0.001380139751176,0.00144014582731409,0.00156015797959027,0.00168017013186644,0.00174017620800453,0.00174017620800453],[0.0138737256468608,0.0181619681195269,0.0191709663483895,0.0206844636916834,0.0221979610349773,0.0234592088210555,0.0240898327140947,0.0306483212017016,0.0388464318112103,0.0398554300400729,0.0418734264977981,0.0422518008336215],[0.0832900469541546,0.0920574203177499,0.0973480766578504,0.101429440120214,0.110196813483809,0.114429338555889,0.117301409140515,0.144510498889604,0.167335901956895,0.174138174394167,0.181696254880025,0.18623110317154],[0.0164012611702104,0.0180413872872315,0.0180413872872315,0.0180413872872315,0.0180413872872315,0.0196815134042525,0.0196815134042525,0.0278821439893577,0.0278821439893577,0.0295222701063788,0.0311623962233998,0.0328025223404209],[0.0286504305175074,0.0315476650642216,0.033801069711666,0.0373421341576501,0.0395955388050945,0.0424927733518087,0.0447461779992531,0.0547255414379355,0.0598761806320941,0.0637391600277131,0.0656706497255226,0.0666363945744273],[0.00679686369756518,0.00801058935784467,0.00914339997410553,0.00962889023821733,0.0110853610305527,0.0114899362506459,0.0118945114707391,0.0140792176592422,0.0149692831434471,0.0153738583635403,0.0157784335836334,0.0158593486276521],[0.00503830061462799,0.00575805784528914,0.00575805784528914,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028,0.00647781507595028],[0.00174285163815081,0.00184893825960347,0.00190955918614785,0.00190955918614785,0.00197018011269222,0.00206111150250879,0.00209142196578097,0.00242483706177504,0.00260669984140817,0.00268247599958864,0.00309166725376318,0.00310682248539927],[0.00674606469609963,0.00796485889320854,0.00864994544030956,0.00912931194777119,0.00958538939414156,0.00995607361651067,0.0102064310232416,0.0125993820503679,0.0132553572711049,0.0136357452689287,0.0139714958996609,0.0140685336542078],[0.0716520371768036,0.0934591789262655,0.0934591789262655,0.0965744848904744,0.10903570874731,0.115266320675727,0.115266320675727,0.130842850496772,0.140188768389398,0.143304074353607,0.146419380317816,0.146419380317816],[0.00983605720035829,0.0111190211830137,0.0124019851656692,0.0128296398265543,0.0141126038092097,0.01496791313098,0.0162508771136354,0.017961495757176,0.0192444597398314,0.0196721144007166,0.0200997690616017,0.0200997690616017],[0.000144845538716679,0.000231752861946686,0.000289691077433357,0.000318660185176693,0.000318660185176693,0.000318660185176693,0.000434536616150036,0.000463505723893371,0.000521443939380043,0.000579382154866714,0.000579382154866714,0.00060835126261005],[2.63534341895095E-05,2.63534341895095E-05,2.63534341895095E-05,2.63534341895095E-05,2.63534341895095E-05,0.000052706868379019,0.000052706868379019,7.90603025685286E-05,7.90603025685286E-05,0.000105413736758038,0.000105413736758038,0.000105413736758038],[0.0629877139746927,0.0694330859905622,0.0722242751044373,0.0752700293315442,0.0786931176626614,0.08240687963371,0.0849976664244026,0.0910061252672075,0.095447474051252,0.0983181019238661,0.101049711968687,0.102149216606688],[5.14201187350842,5.8635681373676,6.06386361903044,6.23501774987758,6.42423130939925,6.61672840140718,6.75545764895235,7.34854570428598,7.72245796616067,7.93301448684313,8.10498950081184,8.18174207267854],[0.104132578411619,0.113185665169203,0.120913909962262,0.127979733773059,0.15109822605401,0.158870632245886,0.166289747247223,0.177683388142133,0.18229825431856,0.187420976581387,0.191594228769639,0.194155589901053],[0.00401663746997159,0.00469253089173719,0.00498295384640209,0.00533498167023834,0.0064086665329389,0.00681877894770813,0.00724121233631163,0.00750875348242718,0.00806495744408845,0.00851379291947966,0.00901367242932714,0.00912632133295474],[0.00129069673202678,0.00154883607843214,0.00175534755555642,0.00185860329411856,0.00185860329411856,0.00191023116339963,0.00191023116339963,0.00206511477124285,0.00216837050980499,0.00242650985621035,0.0026846492026157,0.00278790494117785],[0.000659887851317366,0.000694618790860386,0.000729349730403405,0.000729349730403405,0.000764080669946424,0.000833542549032463,0.00100719724674756,0.00111139006537662,0.00121558288400568,0.00131977570263473,0.00142396852126379,0.00142396852126379],[0.000231739572485909,0.000238981434126094,0.000253465157406463,0.000304158188887756,0.000318641912168125,0.000318641912168125,0.000318641912168125,0.00032588377380831,0.00032588377380831,0.000340367497088679,0.000347609358728864,0.000347609358728864],[0,0,0,0,0,0,0,0,0,0,0,0],[0.0124445733256342,0.015108096748481,0.0165730346310467,0.0182007433894531,0.0198432495002086,0.0209382535740456,0.0219444735337877,0.0275970621311626,0.0297130835170909,0.0318291049030192,0.0337527607084085,0.0340043156983441],[0.103856344797022,0.139225378628825,0.1437268920256,0.146299185395186,0.155623748859934,0.169771362392655,0.17620209581662,0.226683353194739,0.238580210029072,0.249190920178613,0.25690780028737,0.257550873629767],[0.000154243352418082,0.000308486704836164,0.000308486704836164,0.000308486704836164,0.000462730057254246,0.000616973409672328,0.00077121676209041,0.00077121676209041,0.00077121676209041,0.00077121676209041,0.00077121676209041,0.00077121676209041],[0,0,0,0,0,0,0,0,0,0,0,0],[0.149251476648915,0.16701950958331,0.181233935930825,0.188341149104583,0.202555575452099,0.216770001799615,0.229207624853691,0.351807052101014,0.382012708089485,0.433540003599229,0.481513692522095,0.492174512282732],[0.433553804013159,0.48456013389706,0.514738879078368,0.537479201151607,0.615263854224556,0.673071028092977,0.710900722756871,0.876033715756,0.975071006280575,1.04711744724159,1.12213925744582,1.14105410477777],[1.29205454187938,1.43981209116574,1.53544484534056,1.6148798312061,1.71804643110616,1.80091873408385,1.87493876833437,2.02683993276961,2.13358510938916,2.20040090366492,2.28219021631961,2.30865284942953],[0.00637441595696401,0.00637441595696401,0.00708268439662668,0.00708268439662668,0.00708268439662668,0.00708268439662668,0.00708268439662668,0.00849922127595202,0.00849922127595202,0.00849922127595202,0.00849922127595202,0.00849922127595202],[0.986684873910456,1.17202685610775,1.27959485412623,1.39606236277213,1.56360532371457,1.77835438450685,1.93467622335384,2.28678729600423,2.43537042995781,2.56925002461389,2.80373278288438,2.84629565979816],[0.0462086525386541,0.0509654255941038,0.0550426596416321,0.0577608156733177,0.0682936702960991,0.0723709043436274,0.0730504433515488,0.0856219149980944,0.0900389185495834,0.0944559221010724,0.0975138476367187,0.09819338664464],[0.000882321660305794,0.00107532952349769,0.0011304746272668,0.00120629914494933,0.00133726876640097,0.00142687956002578,0.00147513152582375,0.00157852859539084,0.00170949821684248,0.00175085704466931,0.00182668156235184,0.00187493352814981],[0.00872576679393721,0.0107749999046346,0.0117004600191431,0.0125598158397581,0.0130886501909058,0.0140141103054143,0.0147412575382424,0.0181786808207025,0.0191702452291045,0.0206245396947607,0.0214838955153757,0.0216161041031626],[0.00366138034031494,0.0060198370460133,0.00699290659591682,0.00801545425852729,0.00938434871008648,0.0108851847955309,0.0119572105708483,0.0172348759262572,0.019527361815013,0.02033550432256,0.0212096176470496,0.0213745446894061],[0,0,0,0,0,0,0,0,0,0,0,0],[0.365549643565413,0.404660462084199,0.422817881615209,0.441402921533724,0.469757442612945,0.594622595764597,0.631858463353551,0.734783401238566,0.788729357816203,0.822610050057036,0.854089489352645,0.862082701211404],[2.15881222912281,2.21961838627607,2.28197374488546,2.34897670786326,2.42721138139803,2.49421434437583,2.53797928551162,2.94387006701874,3.03566025329468,3.13442184612323,3.19677720473262,3.20607241346943],[0.000443276885647277,0.000443276885647277,0.0005089475353728,0.000525365197804181,0.000591035847529703,0.000689541822117987,0.00075521247184351,0.00100147740831422,0.00111640104533388,0.00132983065694183,0.00139550130666735,0.0014447542939615],[0.186803617391486,0.231938826680296,0.249863335632312,0.260985169500128,0.278909678452144,0.286036290445114,0.294944555436326,0.385538910922718,0.411993758472379,0.425167192762414,0.443631596562382,0.447032934104481],[0.0242625553173113,0.0314514605965146,0.0368431395559172,0.0620043080331289,0.0629029211930293,0.0655987606727305,0.0655987606727305,0.0709904396321331,0.0709904396321331,0.0745848922717347,0.0799765712311372,0.0799765712311372],[0,0,0,0,0,0,0,0,0,0,0,0],[1.21188405479859,1.30967176040273,1.3641414909615,1.44586107571837,1.53690376790714,1.60696197391476,1.66547871252276,1.76032859006154,1.82834830312585,1.89364003298662,1.96621637733598,1.99193736182659],[0.000191147542570505,0.000191147542570505,0.000191147542570505,0.000191147542570505,0.000254863390094006,0.000254863390094006,0.000254863390094006,0.000382295085141009,0.000382295085141009,0.000446010932664511,0.000446010932664511,0.000509726780188012],[1.5511715283615,1.8171874698777,1.97381114156631,2.0912110341232,2.23120870946705,2.35105160556848,2.46105462628219,2.76724440386409,2.95467706469769,3.08802434150364,3.21112457566445,3.25156985656844],[0.0137030424668309,0.0158293766427184,0.0181919701714824,0.0193732669358643,0.0205545637002463,0.0214996011117519,0.0226808978761339,0.0321312719911896,0.0363839403429647,0.0396915712832343,0.0427629428706274,0.0432354615763802],[0.00230889161380057,0.00259750306552564,0.00303042024311324,0.00339118455776958,0.00353549028363212,0.00404056032415099,0.00483424181639493,0.00519500613105127,0.00570007617157015,0.00598868762329522,0.00671021625260789,0.00671021625260789],[0.000267258056835107,0.000267258056835107,0.000267258056835107,0.000334072571043884,0.000400887085252661,0.000400887085252661,0.000467701599461438,0.000467701599461438,0.000668145142087768,0.000734959656296545,0.000734959656296545,0.000734959656296545],[0.00820883121569032,0.00820883121569032,0.00820883121569032,0.00820883121569032,0.00820883121569032,0.00820883121569032,0.00820883121569032,0.0131341299451045,0.024626493647071,0.024626493647071,0.024626493647071,0.024626493647071],[0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586,0.00291921451482586],[0,0,0,0,0,0,0,0,0,0,0,0],[0.280590460328406,0.323003816338102,0.338670010900242,0.360704577235609,0.387451738683165,0.412288388598752,0.438780815175379,0.526791713081384,0.573280827025945,0.598117476941532,0.612255262278097,0.620406778147829],[0.000159996710258308,0.000239995065387462,0.000239995065387462,0.000239995065387462,0.000279994242952039,0.000279994242952039,0.000279994242952039,0.000279994242952039,0.000279994242952039,0.000279994242952039,0.000319993420516616,0.000319993420516616],[0.017465598331256,0.0189976683603136,0.0219086014155229,0.0242067064591092,0.0278836745288473,0.0289561235491876,0.0300285725695279,0.0381485437235329,0.0398338207554962,0.0402934417642134,0.0412126837816479,0.0415190977874594],[0.000583813243686383,0.000750617027596778,0.000834018919551976,0.000834018919551976,0.000917420811507173,0.000917420811507173,0.00100082270346237,0.00100082270346237,0.00100082270346237,0.00133443027128316,0.00133443027128316,0.00133443027128316],[0.00792344062288457,0.00851036215050565,0.00939074444193727,0.00968420520574781,0.00983093558765308,0.0114449697886111,0.0117384305524216,0.0132057343714743,0.0136459255171901,0.0139393862810006,0.0140861166629059,0.0140861166629059],[0.170161619195868,0.188351309523702,0.201553504116485,0.206834381953598,0.217982901831948,0.222677015464938,0.230598332220607,0.261110070835039,0.272258590713389,0.280766671673182,0.287807842122666,0.290741663143285],[0.0351466648567292,0.036338077224754,0.0399123143288281,0.0405080205128405,0.0405080205128405,0.0411037266968528,0.0422951390648776,0.0440822576169147,0.044677963800927,0.0452736699849394,0.0458693761689517,0.0464650823529641],[1.68225618173125,1.84769697154864,1.89936286604311,1.93399000809791,2.0888044791895,2.13295866561917,2.19085378143566,2.31195717243156,2.39312026200975,2.44203797062686,2.48216148443639,2.49755132534964],[0.0036885069909371,0.00464915008931384,0.00513853430924161,0.00543760244364192,0.00589979865135148,0.00628043082240641,0.00685137907898882,0.00809296497028705,0.00871828925130587,0.00931642552010648,0.0103223819721802,0.0111923983631629],[0.00971302480393065,0.0116953874557846,0.0136170091907294,0.0149367436581196,0.0166374893315765,0.0175872563959745,0.0187247681126372,0.0321926859618622,0.037830547431341,0.040204965092336,0.0426014703594798,0.0434076679839106],[0.506423757681577,0.570054413352627,0.606278606843263,0.638213093210007,0.681348481511355,0.727581991624403,0.757848258554078,0.961371029876463,1.06813707384886,1.12557148589651,1.19921145818998,1.22113662793431],[0.00113917033848885,0.00145168609506543,0.00162306570351066,0.00189525684633543,0.00208679876165656,0.00244972028542292,0.00278239834887542,0.00333686178796291,0.00356872831703586,0.00388124407361245,0.00423408444394085,0.0043550582851963],[0.000713207550120567,0.000713207550120567,0.000788282029080626,0.000863356508040686,0.000975968226480775,0.00108857994492087,0.00108857994492087,0.00142641510024113,0.00153902681868122,0.00157656405816125,0.00157656405816125,0.00161410129764128],[0.137891987702968,0.77543772182132,0.789685468769252,0.801312940416414,0.811302740000596,0.82358528047295,0.836359122564199,0.856338721732563,0.86665605572934,0.874680648837945,0.885653051659916,0.887945792548088],[2.1394550857899,2.39057552316453,2.65535205683144,2.8586761571831,3.0324120489015,3.21525200481475,3.46409642614067,4.03385911033507,4.28118618762851,4.43823129498968,4.59755241839957,4.65369414760115],[0.997651792678648,1.14054026695734,1.20255163216188,1.2738842376807,1.38132967244104,1.47242107479371,1.5447583648973,1.7305133814596,1.85777342886406,1.93625045809681,2.0036201410868,2.02767675531106],[0.0424464033313627,0.0515420611880833,0.0560898901164436,0.0682174339254043,0.078829034758245,0.0848928066627254,0.0909565785672058,0.104600065352287,0.113695723209007,0.122791381065728,0.139466753803049,0.140982696779169],[0.0169311795246559,0.0180475210317761,0.0193499194567496,0.0206523178817232,0.0213965455531366,0.0234431716495236,0.0251176839102038,0.0480026848061673,0.0623290674808762,0.0643756935772632,0.0671665473450636,0.0675386611807703],[0.437759289905593,0.512618425600941,0.571983251621681,0.611259524982899,0.651842004682965,0.685758327895117,0.723052770949118,0.780255600271075,0.817054585748271,0.844484918864076,0.863807764359446,0.87155491919675],[0.000297983279304238,0.000352714902033588,0.000395283941934193,0.000419609107591682,0.000486503313149777,0.000516909770221638,0.000529072353050382,0.000711511095481548,0.000833136923768992,0.000875705963669598,0.00093651887781332,0.000960844043470809],[0.00317310831684976,0.00375003710173153,0.00424042656888104,0.00444235164358966,0.00490389467149508,0.00542313057788868,0.00565390209184139,0.00657698814765222,0.0068942989793372,0.00758661352119533,0.00845200669851799,0.00865393177322661],[0.00299592380134683,0.00427989114478119,0.00462228243636369,0.0053926628424243,0.00590624977979804,0.00633423889427616,0.00641983671717179,0.00667663018585866,0.00710461930033678,0.0071902171232324,0.00727581494612802,0.00727581494612802],[0.00548743532433412,0.00660352386487665,0.00716156813514791,0.00790562716217627,0.0081846492973119,0.00920773045947589,0.00967276735136861,0.0128350182162391,0.0134860698648889,0.0140441141351602,0.0152532100540813,0.0156252395675954],[0.343022765410089,0.422807319735102,0.494291570106982,0.569163699643407,0.657248557921553,0.758376750983194,0.828505849689257,0.942169195659711,1.00416738437087,1.11444285117678,1.22031407506878,1.25741135192054],[0,0,0,0,0,0,0,0,0,0,0,0],[0.0469865759820658,0.0552783246847833,0.0644913787989139,0.0718618220902183,0.0764683491472836,0.0792322653815228,0.083838792438588,0.142802338769024,0.156621919940219,0.168598890288589,0.180575860636959,0.181497166048372],[0.00277421505556259,0.00298761621368279,0.00320101737180299,0.00320101737180299,0.00320101737180299,0.00320101737180299,0.00327215109117639,0.00377008712679018,0.00384122084616358,0.00419688944303058,0.00426802316240398,0.00426802316240398],[0.25196217025677,0.259986443194884,0.272825279895866,0.285664116596848,0.290478680359716,0.308132080823566,0.327390335875039,0.571328233193696,0.690087472677779,0.725394273605479,0.781564184172275,0.786378747935143],[0.00085224576574858,0.00187494068464688,0.00187494068464688,0.00187494068464688,0.00187494068464688,0.00204538983779659,0.00204538983779659,0.00204538983779659,0.00238628814409602,0.00238628814409602,0.00255673729724574,0.00255673729724574],[9.33065598473501E-06,9.33065598473501E-06,9.33065598473501E-06,0.00001866131196947,0.00001866131196947,0.00001866131196947,0.000027991967954205,0.0001866131196947,0.000195943775679435,0.00020527443166417,0.000214605087648905,0.000214605087648905],[0.0172789941073373,0.0212060382226412,0.0227768558687628,0.0253948852789654,0.0264420970430465,0.0272275058661073,0.0290601264532491,0.0395322440940596,0.0452919087965054,0.048957149970789,0.0523605882040525,0.0534077999681335],[0.00270383109871223,0.00378536353819712,0.00378536353819712,0.00378536353819712,0.00378536353819712,0.00378536353819712,0.00432612975793956,0.00432612975793956,0.00486689597768201,0.00486689597768201,0.00486689597768201,0.00486689597768201],[0.107128652431951,0.117343854008592,0.124415916638574,0.136988472425209,0.155585377859606,0.163967081717363,0.180468561187321,0.215828874337231,0.235997349244958,0.257213537134904,0.275810442569302,0.282096720462619],[7.18193495550358,7.79046607265128,8.06303730220702,8.47506357944244,8.84905666185613,9.26742180489517,9.59070396087989,11.1500649485709,11.8980511133983,12.455871304117,13.0073526290321,13.1214522134973],[0.128828095618488,0.139123783587998,0.147043543564544,0.153115359546563,0.167106935505129,0.173442743486366,0.180570527465257,0.206705735387861,0.218057391354244,0.225185175333135,0.233896911307336,0.234952879304209],[0.0169952051160606,0.0188345130290542,0.019754166985551,0.020600248625528,0.0216670472150643,0.0226970596463407,0.0237270720776171,0.0271113986375253,0.0284357003348807,0.0293921404496373,0.0307900144635124,0.03148895147045],[0.0259567785476374,0.0384359990032323,0.0394343366396799,0.0414310119125751,0.0459235312765892,0.0479202065494844,0.048918544185932,0.0579035829139603,0.065890284005541,0.0698836345513314,0.0748753227335694,0.0763728291882408],[0.000734015240939397,0.000762246596360143,0.000790477951780889,0.000818709307201635,0.000818709307201635,0.000846940662622381,0.000875172018043127,0.000903403373463873,0.000931634728884619,0.000931634728884619,0.00169388132524476,0.00186326945776924],[0.0893620135221784,0.0988463289163194,0.106937134034384,0.115771144633023,0.128110044713914,0.136479551887194,0.142230948844817,0.150794702905065,0.159223328696118,0.166013524223179,0.172879729401662,0.174822198271344],[0.0618183880690116,0.0657227073154754,0.0728806259339926,0.0839428637989736,0.0904500625430801,0.0995601407848291,0.108670219026578,0.143809092244753,0.157474209607377,0.173742206467643,0.182852284709392,0.185455164207035],[0.000269100098040152,0.000269100098040152,0.000269100098040152,0.000309465112746175,0.00033637512255019,0.000349830127452197,0.000363285132354205,0.000363285132354205,0.000376740137256213,0.000403650147060228,0.000403650147060228,0.000403650147060228],[7.53656923952472E-05,0.00010048758986033,0.00010048758986033,0.00010048758986033,0.00010048758986033,0.00010048758986033,0.00010048758986033,0.000376828461976236,0.000477316051836566,0.00052755984676673,0.00052755984676673,0.00052755984676673],[0.024412880938856,0.0329573892674556,0.0329573892674556,0.0329573892674556,0.0329573892674556,0.0329573892674556,0.0341780333143984,0.0390606095021696,0.0415018975960552,0.042722541642998,0.0463844737838264,0.0500464059246548],[0.000359304129011394,0.00036987189751173,0.000380439666012065,0.000528388425016757,0.000591795036018767,0.000612930573019438,0.000644633878520443,0.00080315040602547,0.000855989248527146,0.000972234702030832,0.00109904792403485,0.00112018346103552],[0.000814223193397397,0.000835100711176818,0.000855978228956238,0.000855978228956238,0.000855978228956238,0.00106475340675044,0.00108563092452986,0.0011273859600887,0.00121089603120639,0.00123177354898581,0.00127352858454465,0.00127352858454465],[7.96432639535299E-05,7.96432639535299E-05,7.96432639535299E-05,7.96432639535299E-05,0.000111500569534942,0.000111500569534942,0.000143357875116354,0.00015928652790706,0.00015928652790706,0.00015928652790706,0.00015928652790706,0.00015928652790706],[0.00174137276531403,0.00226378459490824,0.00226378459490824,0.00278619642450244,0.00278619642450244,0.00278619642450244,0.00296033370103385,0.00330860825409665,0.00330860825409665,0.00330860825409665,0.00330860825409665,0.00330860825409665],[0.0285329029015929,0.0328303278569992,0.0364281720057114,0.0387267946562776,0.0437238004183779,0.0477214050280582,0.0526684407325375,0.0634619731786742,0.0687587992865006,0.0779033198311442,0.0878973313553449,0.089946103717806],[0.000219356832641216,0.000239298362881327,0.000259239893121438,0.000259239893121438,0.000319064483841769,0.000378889074562101,0.000478596725762654,0.000558362846723097,0.000578304376963207,0.000598245907203318,0.000638128967683539,0.000638128967683539],[0.0664609967134665,0.0754422124855566,0.0763403340627656,0.0781365772171836,0.0871177929892737,0.0889140361436917,0.0889140361436917,0.0934046440297367,0.100589616647409,0.102385859801827,0.107774589265081,0.107774589265081],[6.48048568381647E-05,7.77658282057976E-05,7.77658282057976E-05,7.77658282057976E-05,7.77658282057976E-05,7.77658282057976E-05,7.77658282057976E-05,9.07267995734306E-05,0.000103687770941064,0.000103687770941064,0.000103687770941064,0.000103687770941064],[0.000775123779383783,0.000919332854617975,0.00106354192985217,0.0014601168867462,0.00165840436519321,0.0018026134404274,0.00192879638125732,0.00216313612851288,0.0023614236069599,0.00255971108540691,0.00281207696706675,0.00297431217670521],[0.00613922892979997,0.00654851085845331,0.00791278395396441,0.00818563857306663,0.00845849319216885,0.0090042024303733,0.00941348435902663,0.0105049028354355,0.0114598940022933,0.0115963213118444,0.0115963213118444,0.0117327486213955],[3.30103947228116,3.72509757773625,3.88606458794913,4.12338150935061,4.36118473591889,4.54014503730361,4.79205111370927,5.99662901188847,6.62785311840305,6.99404090900819,7.29263228142726,7.35585195311207],[0.161273803757712,0.179241075972941,0.187927955332256,0.197855817457187,0.21085915860995,0.225211394073166,0.234707610018752,0.262710655903748,0.282944070560537,0.294922252037356,0.304796158389869,0.307493947010774],[0.00836058149627337,0.0107656802828726,0.011452851364758,0.0122545509602911,0.0125981365012338,0.0130562505558242,0.0138579501513572,0.017751919615375,0.0200424898883266,0.0214168320520975,0.0223330601612782,0.0224475886749258],[0.505979000534176,0.595203393604343,0.623697836394746,0.648201810172926,0.683928978047983,0.707934143199635,0.734308649327294,0.783940107666814,0.804578314589404,0.838372599036665,0.871730425935714,0.889500483255768],[0.00164441853109144,0.00196269308549623,0.00206878460363116,0.00222792188083356,0.00233401339896849,0.00249315067617089,0.00265228795337329,0.00440279800259966,0.00530457590674657,0.00551675894301644,0.00599417077462363,0.00604721653369109],[0.00408908155202507,0.00534562223728277,0.00583546013153577,0.00626140612653838,0.00664475752204073,0.00709200081679348,0.007667027910047,0.012884866348829,0.0153766504195943,0.0164202181073507,0.018102704787611,0.0183369750848624],[0.0251763992087355,0.0269431640654888,0.0280473921009597,0.0300350025648072,0.0320226130286547,0.0340102234925023,0.0346727603137848,0.0435065845975516,0.047923496739435,0.0499111072032826,0.0514570264529418,0.0516778720600359],[0.00570770295465968,0.00655423867377774,0.00696468023456226,0.00743925328921936,0.00788817374632742,0.00823448381323936,0.00840122569730807,0.0101456023306423,0.0105047386963287,0.0109408328546623,0.0110947484399565,0.011158879933829],[0.0283015678630635,0.0327064811491435,0.0370563330191474,0.0408005093123153,0.0442143171090273,0.0475180020735872,0.0504913185416912,0.0556670916528351,0.060512496267523,0.0665692520358829,0.0711393495701908,0.0731215605489268],[0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405,0.000217519707168405],[0.183521676020133,0.201652603142381,0.211149755444511,0.221402363043401,0.238292185035257,0.256423112157505,0.273097089778858,0.307200500318324,0.338174167485497,0.359758604535792,0.376540504342397,0.382044535790222],[0.192495703817766,0.211004906107936,0.229514108398106,0.25172515114631,0.273936193894514,0.296147236642717,0.303550917558785,0.38684232786455,0.403500609925702,0.427562572902923,0.442369934735059,0.444220854964076],[0,0,0,0,0,0,0,0,0,0,0,0],[1.28584381391069,1.46030503489355,1.53209977603876,1.59833042474521,1.74927886800301,1.85409919007502,1.97130410499457,2.44281606746573,2.58999528681341,2.72102068940342,2.83696919635293,2.86945631672114],[0.00392569325693723,0.00421495486534313,0.00433892412608852,0.0044628933868339,0.00454553956066416,0.00483480116907006,0.00483480116907006,0.00520670895130622,0.00520670895130622,0.00524803203822135,0.00528935512513648,0.00528935512513648],[0.130321392897931,0.147319835449835,0.157235593605112,0.165734814881064,0.196898626226222,0.259226248916537,0.267725470192488,0.398046863090419,0.444792580108156,0.475956391453313,0.522702108471049,0.524118645350374],[0.125976582404435,0.143901821737492,0.154828362048081,0.16361244347424,0.170325481312118,0.176467196780815,0.186536753537632,0.20746143530889,0.21745957676956,0.227886210007115,0.23588472317565,0.243240498678857],[0.00155377828495507,0.00182042668740542,0.00191666069731232,0.00210612140431651,0.00239983562205318,0.00272061565507616,0.00296521043025619,0.00343936341656828,0.00371302888224101,0.00394759928138907,0.00419319649417229,0.0042523403127609],[0.0119788376070066,0.0133098195633406,0.0146408015196747,0.0146408015196747,0.0159717834760087,0.0173027654323428,0.0173027654323428,0.0186337473886769,0.020630220323178,0.021295711301345,0.021295711301345,0.021295711301345],[0,0,0,0,0,0,0,0,0,0,0,0],[0.00132887684413112,0.00173364967596417,0.00184820802459616,0.00197040359647028,0.00216897140076574,0.00290978205525263,0.00304725207361102,0.00436849169450001,0.00512457679547117,0.00549880073433568,0.005689731315389,0.00578901521753673],[5.52783246847833E-05,7.60076964415771E-05,7.60076964415771E-05,8.98272776127729E-05,8.98272776127729E-05,0.000117466439955165,0.000145105602297556,0.000228023089324731,0.000234932879910329,0.000276391623423917,0.000304030785766308,0.000304030785766308],[0,0,0,0,0,0,0,0,0,0,0,0],[0.00682186149956086,0.00750404764951694,0.00767459418700596,0.00810096053072852,0.00844205360570656,0.00861260014319558,0.0087831466806846,0.0101475189805968,0.0106591585930638,0.0110002516680419,0.0121088041617205,0.0122793506992095],[0.000586554570610241,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072,0.00175966371183072],[0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00137539757872499,0.00160463050851249,0.00206309636808749,0.00206309636808749,0.00206309636808749],[0.0301096125672039,0.0364484783708258,0.0380331948217312,0.0396179112726367,0.0427873441744476,0.0435797023999004,0.0491262099780695,0.0570497922325968,0.112514868014288,0.114891942690646,0.11885373381791,0.119646092043363],[0,0,0,0,0,0,0,0,0,0,0,0],[2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05,2.61702783679992E-05],[0.0489939388816642,0.0570657372414786,0.0619463595055524,0.0679532792151817,0.0771513750205516,0.0880389169942548,0.0908546606081435,0.110752582146291,0.118824380506105,0.12595759766129,0.132527666093697,0.133653963539252],[0.000841931406737469,0.000947172832579653,0.000947172832579653,0.000947172832579653,0.00105241425842184,0.00115765568426402,0.00115765568426402,0.00136813853594839,0.00136813853594839,0.00136813853594839,0.00136813853594839,0.00136813853594839],[0.594585612379732,0.689473557409333,0.770367237164784,0.804840915035251,0.875494888492544,0.916795037228449,0.952634009272004,1.03898886571981,1.14684710539374,1.21272254924523,1.25572931569749,1.27620872829381],[1.64176624313806,2.02245384767902,2.09418941341693,2.24255160619306,2.3680888462344,2.4626493647071,2.55394917564625,2.87349851393331,3.02512141424298,3.12620334778276,3.24358881899025,3.25663164912441],[0.395617892775483,0.416383030958177,0.439028634448359,0.451511723298071,0.504284781608231,0.518488296164795,0.529090919707018,0.57934335430714,0.6081104725217,0.620513541571093,0.635197174929568,0.638838075844068],[0.00190903051527682,0.00190903051527682,0.00190903051527682,0.00190903051527682,0.00286354577291523,0.00286354577291523,0.00286354577291523,0.00286354577291523,0.00381806103055364,0.00381806103055364,0.00381806103055364,0.00381806103055364],[0.00125161878697086,0.00134102012889735,0.0017880268385298,0.00187742818045629,0.00214563220623576,0.00232443489008874,0.00241383623201523,0.00357605367705961,0.00402306038669206,0.00420186307054504,0.00429126441247153,0.00429126441247153],[0,0,0,0,0,0,0,0,0,0,0,0],[0.00150925376276711,0.00150925376276711,0.00150925376276711,0.00150925376276711,0.00211295526787396,0.00211295526787396,0.00211295526787396,0.00211295526787396,0.00211295526787396,0.0027166567729808,0.00452776128830134,0.00452776128830134],[0.0236838012330003,0.0279899469117277,0.0307214572303234,0.0331316133937901,0.0351561445711022,0.0362487486985405,0.0381126027982882,0.0463392691695882,0.0497134877984417,0.0517058835602409,0.0538910918151174,0.0544695292943495],[0.000586512661881275,0.000586512661881275,0.00070381519425753,0.000821117726633785,0.000821117726633785,0.000821117726633785,0.000821117726633785,0.0012903278561388,0.00199414305039633,0.00211144558277259,0.00222874811514884,0.00222874811514884],[0,0,3.49363999561225E-05,3.49363999561225E-05,3.49363999561225E-05,3.49363999561225E-05,3.49363999561225E-05,0.000069872799912245,0.00013974559982449,0.00013974559982449,0.00013974559982449,0.00013974559982449],[0.00220815903582793,0.00441631807165586,0.00883263614331171,0.00883263614331171,0.00883263614331171,0.00883263614331171,0.00883263614331171,0.00993671566122568,0.0143530337328815,0.0143530337328815,0.0143530337328815,0.0143530337328815],[0.169617175216993,0.214421712066765,0.230423332370255,0.249625276734443,0.275227869220026,0.291229489523516,0.307231109827006,0.34883532261608,0.368037266980268,0.377638239162362,0.400040507587248,0.403240831647946],[0.0193385184406711,0.0220860675087446,0.0239882168635647,0.0252563164334447,0.0264187410391681,0.0281095404656749,0.0291662901072416,0.0347670632075453,0.0386770368813422,0.0421643106985123,0.0453345596232125,0.0464969842289359],[0.113208339752007,0.126818085514543,0.140982460414738,0.146187441552761,0.159242558177639,0.171017761407921,0.178761237445227,0.221553008604549,0.232794914587083,0.244015488679707,0.256366652937558,0.258201195469812],[0.563371119390526,0.628512495435682,0.710448132492479,0.757268496524935,0.827499042573619,0.878390742608896,0.986790063684038,1.09468046775883,1.35219246993733,1.52115291405446,1.69214902617299,1.73235346920086],[0.00181635913104008,0.00189049623842947,0.00198316762266621,0.00198316762266621,0.00203877045320825,0.00211290756059764,0.00216851039113969,0.00235385315961317,0.00242799026700256,0.0024465245438499,0.00257626448178134,0.00259479875862869],[0.00336882117855266,0.00386181939980427,0.00460131673168168,0.00492998221251608,0.00517648132314189,0.00525864769335049,0.0056694795443935,0.00624464413585371,0.00624464413585371,0.00657330961668811,0.00673764235710532,0.00681980872731392],[0.0146512893808776,0.0183070269633402,0.0197523185657092,0.0213676444742392,0.0246266353423261,0.0272621670878225,0.0291042054045672,0.0351971013753383,0.0400997572029821,0.0444072929590621,0.0470144856535317,0.0475812666740685],[0.0207307930369965,0.0231697098648784,0.0242953637854393,0.0254210177060002,0.0259838446662806,0.0279537390272622,0.0285165659875427,0.0331129861631663,0.0349890760307678,0.0363023389380888,0.0369589703917494,0.0370527748851294],[0.179377340634503,0.201368097305365,0.213768361008295,0.223358853976227,0.233227098515539,0.243177772553454,0.25109996414748,0.271916996436055,0.285713185778377,0.29406902821288,0.304215024323573,0.308234358353295],[0.000771869413793166,0.000771869413793166,0.000849056355172483,0.00100343023793112,0.00104202370862077,0.00115780412068975,0.0013893649448277,0.0018524865931036,0.00208404741724155,0.00219982782931052,0.00235420171206916,0.00235420171206916],[0.0138667405604882,0.0182035869371241,0.0193948237101056,0.0202510251406861,0.0211816788695779,0.02185174955438,0.0228568555815832,0.0261141436327045,0.0271378627344856,0.0281801949108444,0.0287199740736017,0.0289247178939579],[0.012548734144668,0.0155667841288287,0.016731645526224,0.0235619691745876,0.0252033647800083,0.0268447603854291,0.0296510173882451,0.0340986699964819,0.0363754445459364,0.0378050471700125,0.0449001120450569,0.0454295944984184],[0.0107745118499627,0.0107745118499627,0.0107745118499627,0.0107745118499627,0.0107745118499627,0.0107745118499627,0.0107745118499627,0.0134681398124534,0.0134681398124534,0.0134681398124534,0.0134681398124534,0.0134681398124534],[0.034931196662512,0.0407530627729307,0.04366399582814,0.0494858619385587,0.052396794993768,0.0553077280489774,0.0582186611041867,0.0931498577666987,0.113526389153164,0.139724786650048,0.145546652760467,0.151368518870885],[6.21916488867952E-05,6.21916488867952E-05,9.32874733301929E-05,0.00012438329777359,0.00012438329777359,0.00012438329777359,0.000155479122216988,0.000186574946660386,0.000217670771103783,0.000217670771103783,0.000248766595547181,0.000248766595547181],[0.0127072736959314,0.0146404015028656,0.0165059374284386,0.0176144442827645,0.0185877673743677,0.0194123883269761,0.0200477520117726,0.0231029050493051,0.0246845550731604,0.0258065803037586,0.0271043444258962,0.0273341568225248],[0.000463782013558151,0.000485866871346634,0.000530036586923601,0.000530036586923601,0.000618376018077534,0.000684630591442984,0.000684630591442984,0.000795054880385401,0.000795054880385401,0.000817139738173884,0.000839224595962368,0.000839224595962368],[0.000254636098199002,0.000297075447898835,0.000339514797598669,0.000424393496998336,0.000594150895797671,0.000679029595197338,0.000763908294597006,0.000806347644296839,0.00123074114129518,0.00190977073649251,0.00195221008619235,0.00195221008619235]];
var oColors=[
"#33A594",
"#1EA2E2",
"#197EBF",
"#DB4C60",
"#7FAD3E",
"#21A554",
"#DEAA00",
"#7E3874",
"#E5632F",
"#606060",
"#992825"];

var colors=[{"h":171.05263157894737,"s":0.5277777777777778,"l":0},{"h":199.59183673469389,"s":0.7716535433070866,"l":0},{"h":203.49397590361446,"s":0.7685185185185186,"l":0},{"h":351.60839160839157,"s":0.6651162790697676,"l":0},{"h":84.86486486486487,"s":0.47234042553191485,"l":0},{"h":143.1818181818182,"s":0.6666666666666667,"l":0},{"h":45.945945945945944,"s":1,"l":0},{"h":308.5714285714286,"s":0.38461538461538464,"l":0},{"h":17.142857142857142,"s":0.7777777777777778,"l":0},{"h":0,"s":0,"l":0},{"h":1.5517241379310327,"s":0.6105263157894736,"l":0}]
colors=colors.map(function(d) {return d3.hsl(d.h,d.s,d.l);})
var colorsMap=countryColors.map(function() {return colors[Math.floor(Math.random()*colors.length)];})

var cScale=d3.scale.linear().domain([0,0.00000001,1,2,7]).range(["white","#fff8f8",oColors[1],oColors[2],oColors[7]]).clamp([true]);

var letters=["O","F","D","J","S","A","U","E","N","B","P","C","T","O","R","V","I","G","L","E","U","M","B","E","A","R","Y","C","H","S","T",];

var months=[
[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,1,-1,2,-1,-1,-1,-1], // MAY
[-1,-1,-1,0,-1,-1,1,-1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1], // JUNE
[-1,-1,-1,0,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,-1,-1,-1,-1,-1,-1,-1,3,-1,-1,-1,-1], // JULY
[-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,-1,-1,3,-1,-1,-1,-1,-1,-1,-1,-1,4,5], // AUGUST
[-1,-1,-1,-1,0,-1,-1,1,-1,-1,2,-1,3,-1,-1,-1,-1,-1,-1,4,-1,5,6,7,-1,8,-1,-1,-1,-1,-1], // SEPTEMBER
[0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,3,-1,-1,-1,-1,-1,-1,-1,-1,4,5,-1,6,-1,-1,-1,-1,-1], // OCTOBER
[-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,1,-1,2,-1,-1,-1,3,-1,4,5,6,-1,7,-1,-1,-1,-1,-1], // NOVEMBER
[-1,-1,0,-1,-1,-1,-1,1,-1,-1,-1,2,-1,-1,-1,-1,-1,-1,-1,3,-1,4,5,6,-1,7,-1,-1,-1,-1,-1], // DECEMBER
[-1,-1,-1,0,-1,1,-1,-1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,-1,-1,-1,4,5,6,-1,-1,-1,-1], // JANUARY
[-1,0,-1,-1,-1,-1,-1,1,-1,2,-1,-1,-1,-1,3,-1,-1,-1,-1,-1,4,-1,-1,-1,5,6,7,-1,-1,-1,-1], // FEBRUARY
[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,1,2,-1,3,4,-1,-1], // MARCH
[-1,-1,-1,-1,-1,0,-1,-1,-1,-1,1,-1,-1,-1,2,-1,3,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1], // APRIL
];

var w=window.innerWidth,h=window.innerHeight;//w=960;h=500;
var margin = {top: 0, right: 0, bottom: 0, left: 0},
    width = w - margin.left - margin.right,
    height = h - margin.top - margin.bottom;

var projection = d3.geo.mercator()
    .scale(width)
    .translate([width / 2, height / 1.6]);

var path = d3.geo.path()
    .projection(projection);

var translate = function translate(d) {
		var p=projection([+d.lon,+d.lat]);
		return "translate(" + p[0] + "," + p[1]+")";}

var totalDuration=5000; // totalduration = about 1 min
if(window.location.search=="?speed=0") {totalDuration=50000;} // 10 times slower
if(window.location.search=="?speed=2") {totalDuration=1000;}  // 5 times faster
//var timeScale=d3.scale.linear().domain([40686.58544,41032.66948]).range([0,60000]);
var timeScale=d3.scale.linear().domain([0,31]).range([0,totalDuration]);

var xLine=d3.scale.linear().domain([0,31]).range([0,w/13]);
var yLine=d3.scale.linear().domain([0,6514]).range([100,0]);
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

var back=svg.append("rect").attr("width",width).attr("height",height).style("fill","#fff").style("opacity","1");
var map = svg.append("g"),
    feature = map.selectAll(".feature");

var g = svg.append("g"),
	circles = g;//.selectAll(".bli");

svg.append("rect")
    .attr("class", "frame")
    .attr("width", width)
    .attr("height", height);

var data,month;
d3.json("world-countries.json", function(collection) {



	feature = feature
    	.data(collection.features)
    .enter().append("path")
    	.attr("class", "feature")
		.attr("d", path)
		.style("stroke","white")
		.attr("id",function(d) {return d.id;})
		
		

	d3.csv("BLI.csv", function(bli) {
	
	bli.forEach(function (index){
		var scores=[
			index.housing,
			index.income,
			index.jobs,
			index.community,
			index.education,
			index.environment,
			index.governance,
			index.health,
			index.lifeSat,
			index.safety,
			index.wlb
		];
		scores.forEach(function(s) {s+=Math.random();}) // jittering
		var m=d3.max(scores);
		var myColor=0;

		scores.some(function(s,i) {if(s==m) {myColor=i;return true;}});
		index.color=oColors[myColor];
		index.max=Math.floor(d3.mean(scores));
	});
	bli=d3.nest().key(function(d) {return d.month;}).entries(bli);
	data=bli;
	var dur=totalDuration/12;
	var gLetters, tLetters, months=["May 2011","June 2011","July 2011","August 2011","September 2011","October 2011", "November 2011", "December 2011", "January 2012","February 2012","March 2012","April 2012","May 2012"],
	lineChart,dot,totalx1,totalx2;
	init();
	function init(){

		month=0;
		d3.selectAll(".feature").style("fill",function(d,i) {
			return "white";//colorsMap[i];
		});
		d3.selectAll("#lineChart").remove();
		d3.selectAll("#gletters").remove();
		gLetters=svg.append("g").attr("transform","translate(50,"+.8*height+")").attr("id","gletters");
	/*var tLetters=gLetters.selectAll(".letters").data(letters).enter().append("text")
		.text(function(d,i){return letters[i];})
		.style("font-size",32).style("fill","#A00")
		.style("font-family","consolas")
		.attr("x",function(d,i){return i*15;})
		.style("opacity",0)
		.attr("y",50)
	;*/
	
	
	tLetters=gLetters.append("text").style("font-size",32).style("fill",oColors[2])
		.style("font-family","Vibur")
		.attr("x",function(d,i){return i*15;})
		.text(months[month])
		.attr("y",50);
	//var 
	totalx1=[0,2236,3243,3464,3613,3791,4331,4814,5118,5632,5947,6251,6495];
	totalx2=[2236,3243,3464,3613,3791,4331,4814,5118,5632,5947,6251,6495,6514];
	lineChart=svg.append("g").attr("transform","translate(0,"+(height-100)+")").attr("id","lineChart");
	lineChart.selectAll("line").data(totalx2).enter().append("line")
		.attr("transform",function(d,i) {return "translate("+(i*width/13)+",0)";})
		.attr("x1",function(d,i){return 0;})
		.attr("y1",function(d,i){return yLine(totalx1[i]);})
		.attr("x2",function(d,i){return 0;})
		.attr("y2",function(d,i){return yLine(totalx1[i]);})
		.attr("id",function(d,i){return "l"+i;})
		.style("stroke",oColors[7]).style("stroke-width",3)
		.style("visibility","hidden");
	lineChart.selectAll("path").data(totalx2).enter().append("path")
		.attr("transform",function(d,i) {return "translate("+(i*width/13)+",0)";})
		.attr("d",function(d,i) {return "M0,100L0,"+yLine(totalx1[i])+"L0,"+yLine(totalx1[i])+"L0,100Z";})
		.style("fill",oColors[7]).style("opacity",.1)
		.style("stroke","none")
		.attr("id",function(d,i) {return "p"+i;})
	;
	dot=lineChart.append("circle").style("fill",oColors[7]).attr("r",5).attr("transform","translate(0,100)");
		

	iterate();
	}

	function iterate() {if(month<13){
		/*tLetters.transition()
			.duration(dur)
			.delay(dur)
			.style("opacity",function(d,i){return months[month][i]>-1?1:0;})
			.attr("x",function(d,i){return months[month][i]>-1?100+months[month][i]*15:i*15;})*/
		tLetters.text(months[month]);

		d3.selectAll(".feature").transition()
			.duration(timeScale(31)).ease("linear")
			.style("fill",function(d,i){return colorMe(i,d3.min([month,11]));})

		lineChart.select("#l"+month).transition().ease("linear")
			.style("visibility","visible")
			.attr("x2",width/13)
			.attr("y2",yLine)
			.duration(timeScale(31));
		lineChart.select("#p"+month).transition().ease("linear")
			.style("visibility","visible")
			.attr("d",function(d,i) {return "M0,100L0,"+yLine(totalx1[month])+"L"+(width/13)+","+yLine(d)+"L"+(width/13)+",100Z";})
			.duration(timeScale(31));
		dot.transition().duration(timeScale(31)).ease("linear")
			.attr("transform","translate("+(month+1)*(width/13)+","+yLine(totalx2[month])+")");

		circles.selectAll(".c"+month).data(bli[month].values).enter()
			.append("circle")
			.classed("bli",1).classed("c"+month,1)
			.attr("transform",translate)
			.attr("r",0)
			.style("visibility","hidden")
			.style("fill",function(d) {return d.color;})
			.style("stroke","none")
			.style("opacity",.5)
			.transition()
				.attr("r",function(d){return 3*d.max;})
				.style("visibility","visible")
				.delay(function(d) {return timeScale(+d.timeSince1);})
				.duration(250)
				.style("stroke-opacity",0)
				.each("end",function(d,i){d3.select(this).remove();
					if(month<13 && i==0){//bli[month].values.length-1)
					
						//console.log(i+"-"+timeScale(+d.timeSince1));
						month=(month+1);
						if(month<13){iterate();}
						else {init();}
					}
				})
		}
	};
})



});

function colorMe(i,step) {
	var l=countryColors[i][step];
	return cScale(l);
	//var c=d3.hsl(0,1,0);//colorsMap[i];
	c.l=l>.5?.5:l;
	return c.toString();
}








